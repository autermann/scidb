--setup
--start-query-logging
create immutable array A <a:int64> [x=0:9,2,0]
create immutable empty array B <x:int64> [a=0:14,3,0]
create immutable empty array D <a:int64> [x=0:9,3,0]
store(build(A,x+3),A)
store(B,C)
store(D,E)
store(build_sparse(D,x+1,x<>1),D)

--test
redimension_store(A,B)
redimension_store(D,C)
unpack(B,row)
unpack(C,row)
redimension_store(B,E)

max(B)
min(B)
avg(B)
rename(B,B1)
rename(B1,B)
subarray(B,10,11)
between(B,11,20)
filter(B,x>1)
project(B,x)
join(B,B)
cross(B,B)
apply(B,z,x-a)
count(B)
sum(B)
sort(B,x)
sort(B,x desc)

max(C)
min(C)
avg(C)
rename(C,C1)
rename(C1,C)
subarray(C,10,11)
between(C,10,20)
filter(C,x>1)
project(C,x)
join(C,C)
cross(C,C)
apply(C,z,x-a)
count(C)
sum(C)
sort(C,x)
sort(C,x desc)

max(E)
min(E)
avg(E)
rename(E,E1)
rename(E1,E)
subarray(E,5,7)
between(E,4,6)
filter(E,x>1)
project(E,a)
join(E,E)
cross(E,E)
apply(E,z,x-a)
count(E)
sum(E)
sort(E,a)
sort(E,a desc)

--cleanup
remove(A)
remove(B)
remove(C)
remove(D)
remove(E)
--stop-query-logging
