--setup
create array timestamps<val:datetimetz null> [x=0:10,10,0]
load(timestamps, '../tests/harness/testcases/data/timestamps.txt')

--test
apply(apply(apply(apply(apply(timestamps, f, strip_offset(val)), g, togmt(val)), h, get_offset(val)), i, apply_offset(g,h)), j, append_offset(f,h))
build(<val:datetime> [x=0:0,1,0], datetime('2010-6-16 20.28.18.19'))
build(<val:datetime> [x=0:0,1,0], datetime('2010-6-16 20.28.18'))
apply(build(<val:datetime> [x=1:3,3,0], datetime('2010-6-16 20.28.18') + (x * 3600 * 12)), hour, hour_of_day(val), day, day_of_week(val))

--cleanup
remove(timestamps)
